<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>The power of the state - COGS 501</title>
<meta name="description" content="Computation can be thought of as a sequence of states, where there is a meaningful relation between the initial and the final state. Think of summing the first \(n\) positive integers. One strategy is to start with an empty store (or accumulator), and (i) either adding \(n\), then \(n-1\), and so on, to the store until you reach 1; or (ii) adding 1, then 2, and so on, to the store until you reach \(n\), and returning the store at the end.">


  <meta name="author" content="First Lastname">
  
  <meta property="article:author" content="First Lastname">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="COGS 501">
<meta property="og:title" content="The power of the state">
<meta property="og:url" content="http://localhost:4000/cogs501/posts/course/state-power/">


  <meta property="og:description" content="Computation can be thought of as a sequence of states, where there is a meaningful relation between the initial and the final state. Think of summing the first \(n\) positive integers. One strategy is to start with an empty store (or accumulator), and (i) either adding \(n\), then \(n-1\), and so on, to the store until you reach 1; or (ii) adding 1, then 2, and so on, to the store until you reach \(n\), and returning the store at the end.">







  <meta property="article:published_time" content="2025-12-06T00:00:00+03:00">






<link rel="canonical" href="http://localhost:4000/cogs501/posts/course/state-power/">












<!-- end _includes/seo.html -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/cogs501/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>




<!-- MathJax configuration for automatic equation numbering -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      packages: ['base','ams'],
      tags: 'all'
    },
    options: {
      // Optional: Ensure equation numbers are on the right
      tagSide: "right",
      tagIndent: "0.8em"
    }
  };
</script>


  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<style>
.mathbox {
  font-style: normal !important;
  border-left: 4px solid #4a90e2;
  background: #d8ebf1;
  margin: 1.2em 0;
  padding: 1em 1.5em;
  box-shadow: 0 1px 6px 0 #ddeef7;
  font-size: 0.8em;
}
.mathbox.theorem       { border-color: #4a90e2; }
.mathbox.definition    { border-color: #50b45a; }
.mathbox.corollary     { border-color: #e28e4a; }
.mathbox.lemma         { border-color: #8e4ae2; }
.mathbox.proof         { border-color: #8898b4; background: #f8f8fa; }
.mathbox .box-title {
  font-weight: bold;
  text-transform: capitalize;
  letter-spacing: 0.03em;
  margin-bottom: 0.4em;
  font-size: 1em;
}
.box-description {
  font-size: 1em;
  font-weight: bold;
  color: #888;
  margin-left: 0.5em;
}

.code-meta {
  margin-top: 0.15rem;      // less gap under the title/link
  margin-bottom: 0.15rem;   // less gap above the excerpt
  font-style: bold;
  font-size: 0.5em;         // smaller than the default body text
  line-height: 1.2;
  color: #111;
}

.browser-filters {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.browser-filters label {
  font-size: 0.8rem;
  margin: 0;
  white-space: nowrap;
}

.browser-filters select {
  font-size: 0.8rem;
  padding: 0.15rem 0.4rem;
}


</style>


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/cogs501/">
          COGS 501
          <span class="site-subtitle">Algorithmic Structures in Cognition</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/cogs501/posts/"
                
                
              >Posts</a>
            </li><li class="masthead__menu-item">
              <a
                href="/cogs501/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/cogs501/tags/"
                
                
              >Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      <nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      
      
        <li>
          
            <span class="nav__sub-title">COGS 501</span>
          

          
          <ul>
            
              <li><a href="/cogs501/syllabus/">Syllabus</a></li>
            
              <li><a href="/cogs501/schedule/">Schedule</a></li>
            
              <li><a href="/cogs501/exercise/browser/">Exercises</a></li>
            
              <li><a href="/cogs501/code/browser/">Code</a></li>
            
          </ul>
          
        </li>
      
        <li>
          
            <span class="nav__sub-title">Posts</span>
          

          
          <ul>
            
              <li><a href="/cogs501/posts/">by Year</a></li>
            
              <li><a href="/cogs501/categories/">by Category</a></li>
            
              <li><a href="/cogs501/tags/">by Tags</a></li>
            
          </ul>
          
        </li>
      
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="The power of the state">
    <meta itemprop="description" content="Computation can be thought of as a sequence of states, where there is a meaningful relation between the initial and the final state. Think of summing the first \(n\) positive integers. One strategy is to start with an empty store (or accumulator), and (i) either adding \(n\), then \(n-1\), and so on, to the store until you reach 1; or (ii) adding 1, then 2, and so on, to the store until you reach \(n\), and returning the store at the end.">
    <meta itemprop="datePublished" content="2025-12-06T00:00:00+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/cogs501/posts/course/state-power/" itemprop="url">The power of the state
</a>
          </h1>
          
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-12-06T00:00:00+03:00">2025-12-06</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Computation can be thought of as a sequence of states, where there is a meaningful relation between the initial and the final state. Think of summing the first \(n\) positive integers. One strategy is to start with an empty store (or accumulator), and (i) either adding \(n\), then \(n-1\), and so on, to the store until you reach 1; or (ii) adding 1, then 2, and so on, to the store until you reach \(n\), and returning the store at the end.</p>

<p>There is a cyclic pattern in this computation. In each cycle the values of \(n\) and  \(store\) change, while the method of computing the next number in the sequence (increasing or decreasing by 1) and the condition on when to stop (\(= 1\) or \(=n\) ) stay constant.</p>

<p>Assume we started the above procedure on number 70. There will be 70 steps in total, until we get the result. Now assume you interrupt the procedure at some point, say after 30 cycles. All the information that you need to be able to continue from there on until the end and return the correct result is called the “state” of the computation at the point of your interruption. In this case, the state consists of the current value of \(n\), the current value of \(store\), how to compute the next number in sequence, and when to stop. The previous values of \(n\) and \(store\) are not relevant, and therefore are not part of the state. We will sometimes use the term “state” to refer only to the parts that may change from cycle to cycle, in this case the current values of \(n\) and \(store\).</p>

<p>Now, a slightly more complicated problem: finding the \(n\)th <a href="/cogs501/exercises/iteration/#fibonacci-def">Fibonacci number</a>. In computing the Fibonacci numbers in a bottom-up iterative manner, we need to keep track of the two previous Fibonacci numbers in order to compute the next one. Therefore, the state of this computation consists of three parts: the current index in the sequence, and the two previous Fibonacci numbers.</p>

<p>You’ve already solved this problem using a <code class="language-plaintext highlighter-rouge">while</code> loop. What about solving it using <code class="language-plaintext highlighter-rouge">proq_seq</code> from <a href="/cogs501/code/python/modules/funcutils/"><code class="language-plaintext highlighter-rouge">funcutils</code></a>?</p>

<p>So far, <code class="language-plaintext highlighter-rouge">proc_seq</code> has been useful in solving problems where in each cycle you were updating the store which could hold a single number, a sum, max value, and so on. But Fibonacci calls for keeping track of two numbers. This was not a problem in the <code class="language-plaintext highlighter-rouge">while</code> loop version since you could name the numbers (e.g. <code class="language-plaintext highlighter-rouge">prev</code> and <code class="language-plaintext highlighter-rouge">curr</code>).</p>

<p>This brings us to the point where you need a more powerful state. Power in this context means a more sophisticated memory. We will expand our power by introducing the data structure <code class="language-plaintext highlighter-rouge">tuple</code>. Tuples are formed by the comma operator, and tuple components are accessed by indexing which starts from 0. Here is how:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A tuple with two components
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="c1"># A 4-tuple created without parentheses
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">k</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># IndexError: tuple index out of range
</span></code></pre></div></div>

<p>With tuples, we can now solve the Fibonacci problem using <code class="language-plaintext highlighter-rouge">proc_seq</code>.</p>

<p>Try before proceeding.</p>

<p>Here is the solution:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the n-th Fibonacci number (n&gt;=1).

    &gt;&gt;&gt; fibonacci(1)
    0
    &gt;&gt;&gt; fibonacci(2)
    1
    &gt;&gt;&gt; fibonacci(8)
    13
    """</span>
    <span class="kn">from</span> <span class="nn">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>
    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">n</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">proc_seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>  
</code></pre></div></div>

<p>A couple of notes:</p>
<ol>
  <li>Now our store is a tuple of two integers, holding the two previous Fibonacci numbers.</li>
  <li>Initializing the store to (-1, 1) is a trick to make the first update produce (1, 0) which corresponds to the first Fibonacci number, and the second update to produce (0,1) as the second Fibonacci number.</li>
  <li>In the end, we return the second component of the store which holds the n-th Fibonacci number.</li>
</ol>

<p>Let’s get back to <a href="/cogs501/posts/course/iteration-by-while">collatz business</a> for some more fun. When we were asked to find the largest integer visited in the sequence seeded by, say 71, we could solve this problem by:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collatz</span> <span class="kn">import</span> <span class="n">collatz</span>
<span class="kn">from</span> <span class="nn">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>

<span class="k">def</span> <span class="nf">largest_in_collatz_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the largest integer in the Collatz sequence seeded by n.

    &gt;&gt;&gt; largest_in_collatz_sequence(11)
    52
    &gt;&gt;&gt; largest_in_collatz_sequence(27)
    9232
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, assume we are interested in the number of times we change “direction” in a Collatz sequence seeded by \(n\). That is, how many triples of consecutive numbers \((a,b,c)\) are there in the sequence such that \((a &gt; b \land b &lt; c) \lor (a &lt; b \land b &gt;c)\)? Let’s think. What do we have to keep the record of in each iteration to be able to count the direction changes? In each cycle I receive a new number; to be able to tell whether this causes a change in direction, I need to know the previous two numbers. Therefore, my store must hold three numbers: the previous two numbers and the current count of direction changes. Let us first agree on an order. Let the first component of the store be the count, the second two-back, and the third one-back. Now we can write the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.

    &gt;&gt;&gt; collatz_direction_changes(8)
    0
    &gt;&gt;&gt; collatz_direction_changes(7)
    9
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">new</span><span class="p">)</span>
    <span class="n">initial_store</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">final_store</span> <span class="o">=</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">initial_store</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>but we mustn’t. This is too hard to read, it takes to be genius to understand what the <code class="language-plaintext highlighter-rouge">update</code> is doing, so even do not attempt to understand it, unless you are one. Let’s try to bring some order into this chaos by naming the components of the store in the definition of <code class="language-plaintext highlighter-rouge">update</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collatz</span> <span class="kn">import</span> <span class="n">collatz</span>
<span class="kn">from</span> <span class="nn">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>

<span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span> <span class="c1"># yes, you can unpack a tuple like this
</span>        <span class="k">if</span> <span class="p">(</span><span class="n">two_back</span> <span class="o">&lt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">two_back</span> <span class="o">&gt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="n">initial_store</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">final_store</span> <span class="o">=</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">initial_store</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>This looks better, I think. But I find it very hard to read long lines. Let’s break the <code class="language-plaintext highlighter-rouge">if</code> condition into multiple lines. The best way to bring such long lines is to wrap the entire condition in a parenthesis, and when this is done, you can break it anywhere inside the parenthesis:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collatz</span> <span class="kn">import</span> <span class="n">collatz</span>
<span class="kn">from</span> <span class="nn">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>

<span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">two_back</span> <span class="o">&lt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span>
            <span class="ow">or</span> 
            <span class="p">(</span><span class="n">two_back</span> <span class="o">&gt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">)):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="n">initial_store</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">final_store</span> <span class="o">=</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">initial_store</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>This is much better. Now, I can read and understand what is going on in the <code class="language-plaintext highlighter-rouge">update</code> function without too much effort.
But still, this logic of direction change looks a little obtruding (either check the dictionary for “obtruding”, or assume I said “ugly”) there. The reason is that it violates the principle of “doing one thing at a time” in a function. Let’s outsource this logic to a separate function. Let’s also make it more somewhat more clever, more beautiful. Doing many logical operations do not look nice, at least to me. Given three numbers is there an arithmetic way to decide whether there is a directional change or not?</p>

<p>Try before proceeding.</p>

<p>Here is my take, perhaps yours was better:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">turning_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="s">"""Retrurn True if y is a turning_point from increasing to decreasing
       or vice versa.

    &gt;&gt;&gt; turning_point(1,2,3)
    False
    &gt;&gt;&gt; turning_point(3,2,1)
    False
    &gt;&gt;&gt; turning_point(1,3,2)
    True
    &gt;&gt;&gt; turning_point(3,1,2)
    True
    &gt;&gt;&gt; turning_point(2,2,3)
    False
    """</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.

    &gt;&gt;&gt; collatz_direction_changes(8)
    0
    &gt;&gt;&gt; collatz_direction_changes(7)
    9
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="k">if</span> <span class="n">turning_point</span><span class="p">(</span><span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="n">initial_store</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">final_store</span> <span class="o">=</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">initial_store</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>Let me tell you something useful. You can <strong>type-cast</strong> booleans to integers by applying the built-in <code class="language-plaintext highlighter-rouge">int</code> to any boolean expression. <code class="language-plaintext highlighter-rouge">True</code> becomes 1 and <code class="language-plaintext highlighter-rouge">False</code> becomes 0.  Therefore, in incrementing the count according whether you observed a turning point or not, you do not even need an <code class="language-plaintext highlighter-rouge">if</code> statement. You can write:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.

    &gt;&gt;&gt; collatz_direction_changes(8)
    0
    &gt;&gt;&gt; collatz_direction_changes(7)
    9
    """</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">turning_point</span><span class="p">(</span><span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)),</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="n">initial_store</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">final_store</span> <span class="o">=</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">initial_store</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>When we enter the way of lambda, we will write this function as below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s">"""Return the number of direction changes in the Collatz sequence seeded by n.

    &gt;&gt;&gt; collatz_direction_changes(8)
    0
    &gt;&gt;&gt; collatz_direction_changes(7)
    9
    """</span>
    <span class="k">return</span> <span class="n">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span>
                    <span class="n">collatz</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">turning_point</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">new</span><span class="p">)),</span>
                                        <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                        <span class="n">new</span><span class="p">),</span>
                    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/cogs501/tags/#programming" class="page__taxonomy-item p-category" rel="tag">programming</a><span class="sep">, </span>
    
      <a href="/cogs501/tags/#tuple" class="page__taxonomy-item p-category" rel="tag">tuple</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/cogs501/categories/#course" class="page__taxonomy-item p-category" rel="tag">course</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-12-06T00:00:00+03:00">2025-12-06</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/cogs501/posts/course/intro-number-theory/" class="pagination--pager" title="Very basic number theory">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item"
     
     
    >
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cogs501/posts/course/intro-number-theory/" rel="permalink">Very basic number theory
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-24T00:00:00+03:00">2025-11-24</time>
      </span>
    

    

    
  </p>


    

    <p class="archive__item-excerpt" itemprop="description">This is a healthy minimum dose of number theory to make you feel comfortable with the concepts we will be using in this course.

</p>
  </article>
</div>

    
      
      



<div class="grid__item"
     
     
    >
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cogs501/posts/course/euclids-algorithm/" rel="permalink">Euclid’s Algorithm
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-24T00:00:00+03:00">2025-11-24</time>
      </span>
    

    

    
  </p>


    

    <p class="archive__item-excerpt" itemprop="description">Check: Make sure you are fine with very basic number theory.

</p>
  </article>
</div>

    
      
      



<div class="grid__item"
     
     
    >
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cogs501/posts/course/higher-order-functions/" rel="permalink">Higher order functions
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-21T00:00:00+03:00">2025-11-21</time>
      </span>
    

    

    
  </p>


    

    <p class="archive__item-excerpt" itemprop="description">Remember our earlier discussion of Collatz function and sequences. Here is our task:

</p>
  </article>
</div>

    
      
      



<div class="grid__item"
     
     
    >
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cogs501/posts/course/iteration-by-while/" rel="permalink">Iteration by <code class="language-plaintext highlighter-rouge">while</code>
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-13T00:00:00+03:00">2025-11-13</time>
      </span>
    

    

    
  </p>


    

    <p class="archive__item-excerpt" itemprop="description">Let’s start with a simple function defined over integers called the Collatz function \(C\).

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        


<div class="page__footer-copyright">&copy; 2025 <a href="http://localhost:4000">COGS 501</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/cogs501/assets/js/main.min.js"></script>




<script src="/cogs501/assets/js/lunr/lunr.min.js"></script>
<script src="/cogs501/assets/js/lunr/lunr-store.js"></script>
<script src="/cogs501/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
